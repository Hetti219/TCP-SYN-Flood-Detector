# TCP SYN Flood Detector - CONSERVATIVE Preset
# ==============================================
#
# USE THIS PRESET WHEN:
#   - You're new to synflood-detector and want to learn how it works
#   - You want minimal false positives while still having protection
#   - Your server has low to moderate traffic
#   - You're testing the tool in a staging environment
#   - You'd rather miss some attacks than block legitimate users
#
# CHARACTERISTICS:
#   - High threshold (200 SYN/sec) - only obvious attacks are blocked
#   - Short block duration (2 minutes) - quick recovery from mistakes
#   - Longer validation intervals - less aggressive checking
#   - Lower resource usage
#
# TRADE-OFFS:
#   ✓ Very low false positive rate
#   ✓ Safe for learning and testing
#   ✗ May miss subtle or slow attacks
#   ✗ Less protection during heavy attacks
#
# TO APPLY THIS PRESET:
#   sudo synflood-ctl preset apply conservative
#
# TO REVERT TO DEFAULTS:
#   sudo synflood-ctl preset apply balanced

# Detection parameters
detection = {
    # High threshold - only blocks IPs sending 200+ SYN packets per second
    # This significantly reduces false positives but may miss slower attacks
    syn_threshold = 200;

    # Standard 1-second detection window
    window_ms = 1000;

    # Less frequent /proc validation (every 10 seconds)
    # Reduces CPU overhead but slightly slower attack confirmation
    proc_check_interval_s = 10;
};

# Enforcement parameters
enforcement = {
    # Short block duration (2 minutes)
    # If a legitimate IP is blocked by mistake, they'll be unblocked quickly
    block_duration_s = 120;

    # Standard ipset name
    ipset_name = "synflood_blacklist";
};

# Resource limits
limits = {
    # Standard tracking capacity
    max_tracked_ips = 10000;

    # Standard hash table size
    hash_buckets = 4096;
};

# Packet capture configuration
capture = {
    nfqueue_num = 0;
    use_raw_socket = false;
};

# Whitelist configuration
whitelist = {
    file = "/etc/synflood-detector/whitelist.conf";
};

# Logging configuration
logging = {
    # Info level - see blocks and important events
    level = "info";
    syslog = true;
    metrics_socket = "/var/run/synflood-detector.sock";
};
