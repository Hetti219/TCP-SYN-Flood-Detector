# TCP SYN Flood Detector - BALANCED Preset (RECOMMENDED)
# ======================================================
#
# USE THIS PRESET WHEN:
#   - You want a good balance between protection and false positives
#   - Your server handles normal web traffic (hundreds to thousands of users)
#   - You're running a production web server, API, or application
#   - You're unsure which preset to choose (start here!)
#
# CHARACTERISTICS:
#   - Moderate threshold (100 SYN/sec) - catches most attacks
#   - 5-minute block duration - reasonable penalty for attackers
#   - Regular validation intervals - good attack confirmation
#   - Suitable for most production environments
#
# TRADE-OFFS:
#   ✓ Good protection against common SYN flood attacks
#   ✓ Reasonable false positive rate
#   ✓ Works well for most use cases
#   ✗ May need tuning for very high-traffic sites
#   ✗ May have occasional false positives during traffic spikes
#
# TO APPLY THIS PRESET:
#   sudo synflood-ctl preset apply balanced
#
# RECOMMENDED NEXT STEPS:
#   1. Monitor for a few days: sudo synflood-ctl logs -f
#   2. Check for false positives: sudo synflood-ctl blocked list
#   3. Add legitimate high-traffic IPs to whitelist if needed

# Detection parameters
detection = {
    # Moderate threshold - blocks IPs sending 100+ SYN packets per second
    # Good balance between catching attacks and avoiding false positives
    syn_threshold = 100;

    # Standard 1-second detection window
    window_ms = 1000;

    # Regular /proc validation every 5 seconds
    proc_check_interval_s = 5;
};

# Enforcement parameters
enforcement = {
    # 5-minute block duration
    # Long enough to deter attackers, short enough to recover from mistakes
    block_duration_s = 300;

    # Standard ipset name
    ipset_name = "synflood_blacklist";
};

# Resource limits
limits = {
    # Track up to 10,000 unique IPs
    # Sufficient for most servers
    max_tracked_ips = 10000;

    # Hash table with 4096 buckets
    # Good performance for up to 10,000 IPs
    hash_buckets = 4096;
};

# Packet capture configuration
capture = {
    nfqueue_num = 0;
    use_raw_socket = false;
};

# Whitelist configuration
whitelist = {
    file = "/etc/synflood-detector/whitelist.conf";
};

# Logging configuration
logging = {
    # Info level - see blocks and important events
    level = "info";
    syslog = true;
    metrics_socket = "/var/run/synflood-detector.sock";
};
