# TCP SYN Flood Detector - AGGRESSIVE Preset
# ==========================================
#
# USE THIS PRESET WHEN:
#   - Your server is under active attack or frequently targeted
#   - Security is more important than occasional false positives
#   - You have a robust whitelist of known good IPs
#   - You're protecting critical infrastructure
#   - You can quickly respond to false positive reports
#
# CHARACTERISTICS:
#   - Low threshold (50 SYN/sec) - catches attacks early
#   - Long block duration (10 minutes) - strong deterrent
#   - Frequent validation - quick attack confirmation
#   - Maximum protection mode
#
# TRADE-OFFS:
#   ✓ Excellent protection against SYN flood attacks
#   ✓ Catches sophisticated and slower attacks
#   ✓ Strong deterrent with longer block times
#   ✗ Higher false positive rate
#   ✗ May block legitimate users during traffic spikes
#   ✗ Requires well-maintained whitelist
#
# IMPORTANT:
#   Before using this preset, ensure your whitelist includes:
#   - Load balancer IPs
#   - Monitoring service IPs
#   - CDN edge server IPs
#   - Office/VPN IP ranges
#   - Any known high-traffic legitimate sources
#
# TO APPLY THIS PRESET:
#   sudo synflood-ctl preset apply aggressive
#
# TO CHECK/ADD TO WHITELIST:
#   sudo synflood-ctl whitelist list
#   sudo synflood-ctl whitelist add <ip>

# Detection parameters
detection = {
    # Low threshold - blocks IPs sending 50+ SYN packets per second
    # Very sensitive - will catch most attacks but may have false positives
    syn_threshold = 50;

    # Standard 1-second detection window
    window_ms = 1000;

    # Frequent /proc validation every 3 seconds
    # Faster confirmation of attacks
    proc_check_interval_s = 3;
};

# Enforcement parameters
enforcement = {
    # Long block duration (10 minutes)
    # Strong deterrent - attackers must wait longer to retry
    block_duration_s = 600;

    # Standard ipset name
    ipset_name = "synflood_blacklist";
};

# Resource limits
limits = {
    # Track up to 10,000 unique IPs
    max_tracked_ips = 10000;

    # Hash table with 4096 buckets
    hash_buckets = 4096;
};

# Packet capture configuration
capture = {
    nfqueue_num = 0;
    use_raw_socket = false;
};

# Whitelist configuration
whitelist = {
    file = "/etc/synflood-detector/whitelist.conf";
};

# Logging configuration
logging = {
    # Info level - see all blocks and events
    # Consider "debug" if you need to investigate false positives
    level = "info";
    syslog = true;
    metrics_socket = "/var/run/synflood-detector.sock";
};
