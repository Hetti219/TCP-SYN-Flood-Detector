# ============================================================================
# TCP SYN Flood Detector - Whitelist Configuration
# ============================================================================
#
# IPs and CIDR ranges listed here will NEVER be blocked, even if they exceed
# the SYN threshold. Use this to protect legitimate high-traffic sources.
#
# Format:
#   One entry per line
#   Single IP:    192.168.1.100
#   CIDR range:   10.0.0.0/8
#   Comments:     Lines starting with # are ignored
#
# Management:
#   Add entry:    sudo synflood-ctl whitelist add <ip>
#   Remove entry: sudo synflood-ctl whitelist remove <ip>
#   List entries: sudo synflood-ctl whitelist list
#   Edit file:    sudo synflood-ctl whitelist edit
#
# After editing: sudo synflood-ctl reload
#
# ============================================================================

# ----------------------------------------------------------------------------
# LOCALHOST (Required)
# ----------------------------------------------------------------------------
# Always whitelist localhost to prevent blocking your own server
127.0.0.1
127.0.0.0/8

# ----------------------------------------------------------------------------
# YOUR INFRASTRUCTURE
# ----------------------------------------------------------------------------
# Add your own IPs here to ensure you never get locked out

# Your office/home IP (REPLACE WITH YOUR ACTUAL IP)
# Find your IP: curl ifconfig.me
# 203.0.113.50

# Your VPN endpoint (if you connect via VPN)
# 198.51.100.10

# Your static IPs or IP ranges
# 192.0.2.0/24


# ----------------------------------------------------------------------------
# PRIVATE NETWORKS
# ----------------------------------------------------------------------------
# Uncomment these if your server is on a private network and you want to
# whitelist all internal traffic (e.g., Docker networks, internal services)

# Class A private network (10.x.x.x)
# 10.0.0.0/8

# Class B private networks (172.16.x.x - 172.31.x.x)
# 172.16.0.0/12

# Class C private networks (192.168.x.x)
# 192.168.0.0/16


# ----------------------------------------------------------------------------
# LOAD BALANCERS
# ----------------------------------------------------------------------------
# Whitelist your load balancer IPs to prevent blocking health checks
# and traffic forwarding

# AWS Elastic Load Balancer (ELB)
# Find IPs: dig +short your-elb-name.region.elb.amazonaws.com
# 52.1.2.3
# 52.1.2.4

# AWS Application Load Balancer (ALB) - VPC CIDR
# Get from AWS Console > VPC > Your VPC > IPv4 CIDR
# 10.0.0.0/16

# Google Cloud Load Balancer health checks
# See: https://cloud.google.com/load-balancing/docs/health-checks#fw-rule
# 35.191.0.0/16
# 130.211.0.0/22

# Cloudflare IPs (if using Cloudflare as reverse proxy/CDN)
# Full list: https://www.cloudflare.com/ips/
# 173.245.48.0/20
# 103.21.244.0/22
# 103.22.200.0/22
# 103.31.4.0/22
# 141.101.64.0/18
# 108.162.192.0/18
# 190.93.240.0/20
# 188.114.96.0/20
# 197.234.240.0/22
# 198.41.128.0/17
# 162.158.0.0/15
# 104.16.0.0/13
# 104.24.0.0/14
# 172.64.0.0/13
# 131.0.72.0/22

# Azure Load Balancer health probe source
# 168.63.129.16


# ----------------------------------------------------------------------------
# MONITORING & UPTIME SERVICES
# ----------------------------------------------------------------------------
# These services make frequent requests to check your site's availability
# Whitelist them to prevent false positives

# Pingdom monitoring (IPv4 probe servers)
# Full list: https://documentation.pingdom.com/probe-servers/
# 5.172.196.0/23
# 23.111.152.0/23
# 43.225.198.0/23
# 46.246.120.0/23
# 50.16.153.192/26
# 52.48.244.0/24
# 64.237.55.0/24
# 66.165.229.0/24
# 72.46.140.0/24
# 76.72.172.208/28
# 76.72.167.96/27
# 82.103.136.0/23
# 85.195.116.0/23
# 94.247.174.0/23
# 103.47.211.0/24
# 104.129.24.0/23
# 107.181.187.224/27
# 138.128.136.0/23
# 148.72.170.0/24
# 159.122.168.0/23
# 162.218.67.0/24
# 162.253.128.0/23
# 168.1.203.192/26
# 169.56.174.0/24
# 173.248.147.18/32
# 178.162.206.0/23
# 185.39.146.0/24
# 185.70.76.0/24
# 185.93.3.0/24
# 185.152.65.0/24
# 185.180.12.0/24
# 188.172.252.0/23
# 196.240.207.0/24
# 198.20.69.72/29
# 207.244.80.0/24

# UptimeRobot monitoring
# Full list: https://uptimerobot.com/inc/files/ips/IPv4.txt
# 63.143.42.242/32
# 63.143.42.243/32
# 63.143.42.244/32
# 63.143.42.245/32
# 63.143.42.246/32

# Datadog monitoring
# Check: https://ip-ranges.datadoghq.com/
# Varies by region - add your specific Datadog agent IPs

# New Relic Synthetics
# https://docs.newrelic.com/docs/synthetics/synthetic-monitoring/administration/synthetic-public-minion-ips/
# Check their documentation for current IP ranges


# ----------------------------------------------------------------------------
# CI/CD & AUTOMATION
# ----------------------------------------------------------------------------
# Whitelist IPs for continuous integration and deployment services

# GitHub Actions runners (dynamic IPs)
# Get current ranges: https://api.github.com/meta (check "actions" field)
# Note: GitHub provides CIDR ranges in their API, add them as needed
# Example ranges (check API for current):
# 13.64.0.0/16
# 13.65.0.0/16
# 20.33.0.0/16

# GitLab.com CI/CD runners
# Check: https://docs.gitlab.com/ee/user/gitlab_com/#ip-range
# Varies by region

# CircleCI
# Static IP ranges available for paid plans
# Check your CircleCI project settings

# Jenkins (self-hosted)
# Add your Jenkins server IP here
# 198.51.100.50

# Docker Hub webhooks
# Check their documentation for current IPs


# ----------------------------------------------------------------------------
# CONTENT DELIVERY NETWORKS (CDNs)
# ----------------------------------------------------------------------------
# If you're behind a CDN, whitelist their edge servers

# Fastly CDN
# Check: https://api.fastly.com/public-ip-list
# Dynamic ranges - get from their API

# Akamai CDN
# Contact Akamai support for current IP ranges for your service

# AWS CloudFront
# Get ranges: https://ip-ranges.amazonaws.com/ip-ranges.json
# Filter by service: CLOUDFRONT


# ----------------------------------------------------------------------------
# PAYMENT PROCESSORS
# ----------------------------------------------------------------------------
# Webhook IPs for payment services (to receive payment notifications)

# Stripe webhooks
# Check: https://stripe.com/docs/ips
# 3.18.12.0/22
# 3.130.192.0/22
# 13.52.14.0/25
# 18.179.48.0/20
# 35.154.171.0/24

# PayPal IPN (Instant Payment Notification)
# Check: https://developer.paypal.com/api/nvp-soap/ipn/IPNIntro/#ipn-protocol-and-architecture
# 64.4.240.0/20
# 64.4.241.0/24
# 66.211.168.0/22
# 147.75.0.0/16
# 173.0.80.0/20
# 216.113.160.0/19


# ----------------------------------------------------------------------------
# SEARCH ENGINE CRAWLERS
# ----------------------------------------------------------------------------
# Legitimate search engine bots (optional - they usually don't trigger SYN floods)
# Only whitelist if you're seeing false positives

# Googlebot
# Verify: https://developers.google.com/search/docs/crawling-indexing/verifying-googlebot
# DNS verification recommended over IP whitelisting

# Bingbot
# https://www.bing.com/webmasters/help/which-crawlers-does-bing-use-8c184ec0
# DNS verification recommended


# ----------------------------------------------------------------------------
# API PARTNERS & INTEGRATIONS
# ----------------------------------------------------------------------------
# Third-party services that integrate with your application

# Zapier webhooks
# https://zapier.com/help/troubleshoot/behavior/set-up-ip-addresses-to-allowlist-for-zapier
# Check their documentation for current ranges

# Slack webhooks/slash commands
# Check: https://api.slack.com/authentication/best-practices#ip_allowlisting
# Varies by region

# Twilio
# Check: https://www.twilio.com/docs/glossary/what-is-an-ip-address
# Varies by service and region

# SendGrid
# Check: https://docs.sendgrid.com/for-developers/sending-email/outbound-ip-addresses
# Varies by region


# ----------------------------------------------------------------------------
# BACKUP & DISASTER RECOVERY
# ----------------------------------------------------------------------------
# Services that need to access your server for backups

# Your backup server
# 203.0.113.100

# Managed backup service IPs
# Check with your provider


# ----------------------------------------------------------------------------
# DEVELOPMENT & TESTING
# ----------------------------------------------------------------------------
# Temporary entries for development (remove in production)

# Local development machine
# 192.0.2.50

# Staging environment
# 198.51.100.0/24


# ============================================================================
# NOTES & BEST PRACTICES
# ============================================================================
#
# 1. START CONSERVATIVE
#    Only whitelist IPs you're absolutely certain are legitimate.
#    Over-whitelisting reduces protection.
#
# 2. USE CIDR RANGES CAREFULLY
#    Large ranges like 0.0.0.0/8 effectively disable protection.
#    Use the smallest range that covers your needs.
#
# 3. REGULARLY REVIEW
#    Service IPs change. Review this list quarterly and update as needed.
#    Remove entries for services you no longer use.
#
# 4. VERIFY SERVICE IPs
#    Always check official documentation for current IP ranges.
#    The examples above may be outdated - verify before use.
#
# 5. MONITOR AFTER WHITELISTING
#    Check logs to ensure whitelisted IPs behave as expected:
#    sudo synflood-ctl logs events | grep whitelist
#
# 6. AVOID WHITELISTING PUBLIC RANGES
#    Never whitelist large public IP ranges unless absolutely necessary
#    and you trust all hosts in that range.
#
# 7. DOCUMENT YOUR ENTRIES
#    Add comments explaining why each IP is whitelisted and when it was added.
#    This helps with maintenance and auditing.
#
#    Example:
#    # Added 2024-01-15: Production load balancer
#    # Contact: ops-team@example.com
#    # 203.0.113.10
#
# 8. TEST BEFORE DEPLOYMENT
#    After adding entries, test that:
#    - Whitelisted IPs are not blocked
#    - Protection still works for other IPs
#    Use: sudo synflood-ctl whitelist list
#
# 9. EMERGENCY ACCESS
#    If you get locked out, access the server via:
#    - Out-of-band management (IPMI, console)
#    - Add your IP directly: ipset add synflood_blacklist -exist <your-ip>
#    - Or stop the service: systemctl stop synflood-detector
#
# ============================================================================
