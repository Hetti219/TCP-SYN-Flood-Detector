# TCP SYN Flood Detector Configuration File
# Software Design Document v1.0

# Detection parameters
detection = {
    # Number of SYN packets per IP per window to trigger detection
    syn_threshold = 100;

    # Detection window in milliseconds
    window_ms = 1000;

    # Interval for /proc/net/tcp validation check (seconds)
    proc_check_interval_s = 5;
};

# Enforcement parameters
enforcement = {
    # How long to block an offending IP (seconds)
    block_duration_s = 300;

    # Name of the ipset to use for blacklisting
    ipset_name = "synflood_blacklist";
};

# Resource limits
limits = {
    # Maximum number of IP addresses to track simultaneously
    max_tracked_ips = 10000;

    # Hash table bucket count (must be power of 2)
    hash_buckets = 4096;
};

# Packet capture configuration
capture = {
    # NFQUEUE number to use
    nfqueue_num = 0;

    # Use raw socket instead of NFQUEUE (fallback mode)
    use_raw_socket = false;
};

# Whitelist configuration
whitelist = {
    # Path to whitelist file containing trusted IPs/CIDRs
    file = "/etc/synflood-detector/whitelist.conf";
};

# Logging configuration
logging = {
    # Log level: debug, info, warn, error
    level = "info";

    # Use systemd journal for logging
    syslog = true;

    # Unix socket path for metrics API
    metrics_socket = "/var/run/synflood-detector.sock";
};
